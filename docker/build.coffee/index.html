<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>Build.coffee - node-nikita</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Build.coffee";
    var mkdocs_page_input_path = "docker/build.coffee.md";
    var mkdocs_page_url = "/docker/build.coffee/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../context.coffee/" class="icon icon-home"> node-nikita</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../context.coffee/">Context.coffee</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../index.coffee/">Index.coffee</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../registry.coffee/">Registry.coffee</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Alt</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../alt/ldap_acl.coffee/">Ldap acl.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../alt/ldap_index.coffee/">Ldap index.coffee</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Connection</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../connection/assert.coffee/">Assert.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../connection/wait.coffee/">Wait.coffee</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Core</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/assert.coffee/">Assert.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/ping.coffee/">Ping.coffee</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Kv</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/kv/engine.coffee/">Engine.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/kv/get.coffee/">Get.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/kv/set.coffee/">Set.coffee</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Engines</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../core/kv/engines/memory.coffee/">Memory.coffee</a>
        
    </li>

        
    </ul>

        
    </ul>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Cron</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../cron/add.coffee/">Add.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../cron/remove.coffee/">Remove.coffee</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Db</span></li>

        
            
    <ul class="subnav">
    <li><span>Database</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../db/database/exists.coffee/">Exists.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../db/database/index.coffee/">Index.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../db/database/remove.coffee/">Remove.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../db/database/wait.coffee/">Wait.coffee</a>
        
    </li>

        
    </ul>

        
            
    <ul class="subnav">
    <li><span>Schema</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../db/schema/index.coffee/">Index.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../db/schema/remove.coffee/">Remove.coffee</a>
        
    </li>

        
    </ul>

        
            
    <ul class="subnav">
    <li><span>User</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../db/user/exists.coffee/">Exists.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../db/user/index.coffee/">Index.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../db/user/remove.coffee/">Remove.coffee</a>
        
    </li>

        
    </ul>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Docker</span></li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Build.coffee</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#nikitadockerbuildoptions-callback">nikita.docker.build(options, [callback])</a></li>
                
                    <li><a class="toctree-l4" href="#options">Options</a></li>
                
                    <li><a class="toctree-l4" href="#callback-parameters">Callback parameters</a></li>
                
                    <li><a class="toctree-l4" href="#example">Example</a></li>
                
                    <li><a class="toctree-l4" href="#source-code">Source Code</a></li>
                
                    <li><a class="toctree-l4" href="#modules-dependencies">Modules Dependencies</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../checksum.coffee/">Checksum.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../cp.coffee/">Cp.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../exec.coffee/">Exec.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../kill.coffee/">Kill.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../load.coffee/">Load.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../login.coffee/">Login.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../logout.coffee/">Logout.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../pause.coffee/">Pause.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../pull.coffee/">Pull.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../restart.coffee/">Restart.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../rm.coffee/">Rm.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../rmi.coffee/">Rmi.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../run.coffee/">Run.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../save.coffee/">Save.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../service.coffee/">Service.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../start.coffee/">Start.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../status.coffee/">Status.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../stop.coffee/">Stop.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../unpause.coffee/">Unpause.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../volume_create.coffee/">Volume create.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../volume_rm.coffee/">Volume rm.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../wait.coffee/">Wait.coffee</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Compose</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../compose/index.coffee/">Index.coffee</a>
        
    </li>

        
    </ul>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>File</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/assert.coffee/">Assert.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/cache.coffee/">Cache.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/cson.coffee/">Cson.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/download.coffee/">Download.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/index.coffee/">Index.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/ini.coffee/">Ini.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/json.coffee/">Json.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/render.coffee/">Render.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/touch.coffee/">Touch.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/upload.coffee/">Upload.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/yaml.coffee/">Yaml.coffee</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Properties</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/properties/index.coffee/">Index.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/properties/read.coffee/">Read.coffee</a>
        
    </li>

        
    </ul>

        
            
    <ul class="subnav">
    <li><span>Types</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/types/ceph_conf.coffee/">Ceph conf.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/types/locale_gen.coffee/">Locale gen.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/types/pacman_conf.coffee/">Pacman conf.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/types/ssh_authorized_keys.coffee/">Ssh authorized keys.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/types/yum_repo.coffee/">Yum repo.coffee</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Etc group</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/types/etc_group/read.coffee/">Read.coffee</a>
        
    </li>

        
    </ul>

        
            
    <ul class="subnav">
    <li><span>Etc passwd</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../file/types/etc_passwd/read.coffee/">Read.coffee</a>
        
    </li>

        
    </ul>

        
    </ul>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Fs</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../fs/chmod.coffee/">Chmod.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../fs/chown.coffee/">Chown.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../fs/copy.coffee/">Copy.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../fs/createReadStream.coffee/">createReadStream.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../fs/exists.coffee/">Exists.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../fs/lstat.coffee/">Lstat.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../fs/mkdir.coffee/">Mkdir.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../fs/readFile.coffee/">readFile.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../fs/readlink.coffee/">Readlink.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../fs/rename.coffee/">Rename.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../fs/rmdir.coffee/">Rmdir.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../fs/stat.coffee/">Stat.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../fs/symlink.coffee/">Symlink.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../fs/unlink.coffee/">Unlink.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../fs/writeFile.coffee/">writeFile.coffee</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Java</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../java/keystore_add.coffee/">Keystore add.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../java/keystore_remove.coffee/">Keystore remove.coffee</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Krb5</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../krb5/addprinc.coffee/">Addprinc.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../krb5/delprinc.coffee/">Delprinc.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../krb5/ktadd.coffee/">Ktadd.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../krb5/ticket.coffee/">Ticket.coffee</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Ktutil</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../krb5/ktutil/add.coffee/">Add.coffee</a>
        
    </li>

        
    </ul>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Ldap</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../ldap/acl.coffee/">Acl.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../ldap/add.coffee/">Add.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../ldap/delete.coffee/">Delete.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../ldap/index.coffee/">Index.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../ldap/schema.coffee/">Schema.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../ldap/user.coffee/">User.coffee</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Log</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../log/cli.coffee/">Cli.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../log/csv.coffee/">Csv.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../log/fs.coffee/">Fs.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../log/md.coffee/">Md.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../log/stream.coffee/">Stream.coffee</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Misc</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../misc/conditions.coffee/">Conditions.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../misc/db.coffee/">Db.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../misc/diff.coffee/">Diff.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../misc/docker.coffee/">Docker.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../misc/krb5.coffee/">Krb5.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../misc/ldap.coffee/">Ldap.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../misc/os.coffee/">Os.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../misc/pidfile_running.coffee/">Pidfile running.coffee</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Service</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../service/assert.coffee/">Assert.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../service/discover.coffee/">Discover.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../service/index.coffee/">Index.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../service/init.coffee/">Init.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../service/install.coffee/">Install.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../service/remove.coffee/">Remove.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../service/restart.coffee/">Restart.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../service/start.coffee/">Start.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../service/startup.coffee/">Startup.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../service/status.coffee/">Status.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../service/stop.coffee/">Stop.coffee</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Ssh</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../ssh/close.coffee/">Close.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../ssh/index.coffee/">Index.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../ssh/open.coffee/">Open.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../ssh/root.coffee/">Root.coffee</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>System</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/cgroups.coffee/">Cgroups.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/chmod.coffee/">Chmod.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/chown.coffee/">Chown.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/copy.coffee/">Copy.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/discover.coffee/">Discover.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/limits.coffee/">Limits.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/link.coffee/">Link.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/mkdir.coffee/">Mkdir.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/mod.coffee/">Mod.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/move.coffee/">Move.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/remove.coffee/">Remove.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/tmpfs.coffee/">Tmpfs.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/uid_gid.coffee/">Uid gid.coffee</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Execute</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/execute/assert.coffee/">Assert.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/execute/index.coffee/">Index.coffee</a>
        
    </li>

        
    </ul>

        
            
    <ul class="subnav">
    <li><span>Group</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/group/index.coffee/">Index.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/group/remove.coffee/">Remove.coffee</a>
        
    </li>

        
    </ul>

        
            
    <ul class="subnav">
    <li><span>User</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/user/index.coffee/">Index.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/user/remove.coffee/">Remove.coffee</a>
        
    </li>

        
    </ul>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Tools</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tools/backup.coffee/">Backup.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tools/compress.coffee/">Compress.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tools/extract.coffee/">Extract.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tools/git.coffee/">Git.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tools/iptables.coffee/">Iptables.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tools/repo.coffee/">Repo.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tools/sysctl.coffee/">Sysctl.coffee</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Rubygems</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tools/rubygems/fetch.coffee/">Fetch.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tools/rubygems/install.coffee/">Install.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tools/rubygems/remove.coffee/">Remove.coffee</a>
        
    </li>

        
    </ul>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Wait</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../wait/execute.coffee/">Execute.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../wait/exist.coffee/">Exist.coffee</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../wait/index.coffee/">Index.coffee</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../context.coffee/">node-nikita</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../context.coffee/">Docs</a> &raquo;</li>
    
      
        
          <li>Docker &raquo;</li>
        
      
    
    <li>Build.coffee</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="nikitadockerbuildoptions-callback"><code>nikita.docker.build(options, [callback])</code></h1>
<p>Build docker repository from Dockerfile, from content or from current working
directory (exclusive options).</p>
<p>The user can choose whether the build is local or on the remote.
Options are the same than docker build command with nikita's one.
Be aware than you can not use ADD with content option because docker build
from STDIN does not support a context.</p>
<p>By default docker always run the build and overwrite existing repositories.
Status unmodified if the repository is identical to a previous one</p>
<h2 id="options">Options</h2>
<ul>
<li><code>boot2docker</code> (boolean) <br />
  Whether to use boot2docker or not, default to false.</li>
<li><code>image</code> (string) <br />
  Name of the image, required.</li>
<li><code>tag</code> (string) <br />
  Tag of the image.</li>
<li><code>machine</code> (string) <br />
  Name of the docker-machine, required if using docker-machine.</li>
<li><code>file</code> <br />
  Path to Dockerfile.</li>
<li><code>content</code> (string | [string]) <br />
  Use this text to build the repository.</li>
<li><code>quiet</code> (boolean) <br />
  Suppress the verbose output generated by the containers. Default to false</li>
<li><code>rm</code> (boolean) <br />
  Remove intermediate containers after build, default to true.</li>
<li><code>force_rm</code> (boolean) <br />
  Always remove intermediate containers during build, default to false.</li>
<li><code>no_cache</code> (boolean) <br />
  Do not use cache when building the repository, default to false.</li>
<li><code>build_arg</code> ("k=v" | []) <br />
  Send arguments to the build (Must match an ARG command).</li>
<li><code>cwd</code> (string) <br />
  change the working directory for the build.</li>
</ul>
<h2 id="callback-parameters">Callback parameters</h2>
<ul>
<li><code>err</code> <br />
  Error object if any.   </li>
<li><code>status</code> <br />
  True if image was successfully built.   </li>
<li><code>checksum</code> <br />
  Image cheksum if built.   </li>
<li><code>stdout</code> <br />
  Stdout value(s) unless <code>stdout</code> option is provided.   </li>
<li><code>stderr</code> <br />
  Stderr value(s) unless <code>stderr</code> option is provided.   </li>
</ul>
<h2 id="example">Example</h2>
<h3 id="builds-a-repository-from-dockerfile-without-any-resourcess">Builds a repository from dockerfile without any resourcess</h3>
<pre><code class="javascript">nikita.docker.build({
  image: 'ryba/targe-build',
  source: '/home/ryba/Dockerfile'
}, function(err, status, stdout, stderr){
  console.log( err ? err.message : 'Container built: ' + status);
});
</code></pre>

<h3 id="builds-an-repository-from-dockerfile-with-external-resources">Builds an repository from dockerfile with external resources</h3>
<p>In this case nikita download all the external files into a resources directory in the same location
than the Dockerfile. The Dockerfile content:</p>
<pre><code class="dockerfile">FROM centos7
ADD resources/package.tar.gz /tmp/
ADD resources/configuration.sh /tmp/
</code></pre>

<p>Build directory tree :</p>
<pre><code>├── Dockerfile
├── resources
│   ├── package.tar.gz
│   ├── configuration.sh
</code></pre>

<pre><code class="javascript">nikita.docker.build({
  ssh: ssh
  tag: 'ryba/target-build'
  source: '/home/ryba/Dockerfile'
  resources: ['http://url.com/package.tar.gz/','/home/configuration.sh']
}, function(err, status, stdout, stderr){
  console.log( err ? err.message : 'Container built: ' + status);
});
</code></pre>

<h3 id="builds-an-repository-from-stdin">Builds an repository from stdin</h3>
<pre><code class="javascript">nikita.docker.build({
  ssh: ssh,
  tag: 'ryba/target-build'
  content: &quot;FROM ubuntu\nRUN echo 'helloworld'&quot;
}, function(err, is_built, stdout, stderr){
  console.log( err ? err.message : 'Container built: ' + status);
});
</code></pre>

<h2 id="source-code">Source Code</h2>
<pre><code>module.exports = (options, callback) -&gt;
  options.log message: "Entering Docker build", level: 'DEBUG', module: 'nikita/lib/docker/build'
  # SSH connection
  ssh = @ssh options.ssh
  # Global options
  options.docker ?= {}
  options[k] ?= v for k, v of options.docker
  # Validation
  return callback Error 'Required option "image"' unless options.image?
  return callback Error 'Can not build from Dockerfile and content' if options.content? and options.file?
  options.rm ?= true
  cmd = 'build'
  number_of_step = 0
  userargs = []
  # status unmodified if final tag already exists
  dockerfile_cmds = ['CMD','LABEL','EXPOSE','ENV','ADD','COPY','ENTRYPOINT',
   'VOLUME','USER','WORKDIR','ARG','ONBUILD','RUN','STOPSIGNAL','MAINTAINER']
  source = null
  if options.file
    source = options.file
  else if options.cwd
    source = "#{options.cwd}/Dockerfile"
  options.cwd ?= path.dirname options.file if options.file
  # Apply search and replace to content
  # options.write ?= []
  # if options.from? or options.to? or options.match? or options.replace? or options.before?
  #   options.write.push
  #     from: options.from
  #     to: options.to
  #     match: options.match
  #     replace: options.replace
  #     append: options.append
  #     before: options.before
  #   options.append = false
  # Build cmd
  for opt in ['force_rm', 'quiet', 'no_cache']
    cmd += " --#{opt.replace '_', '-'}" if options[opt]
  for opt in ['build_arg'] then if options[opt]?
    if Array.isArray options[opt]
      cmd += " --#{opt.replace '_', '-'} #{k}" for k in options[opt]
    else
      cmd += " --#{opt.replace '_', '-'} #{options[opt]}"
  cmd += " --rm=#{if options.rm then 'true' else 'false'}"
  cmd += " -t \"#{options.image}#{if options.tag then ":#{options.tag}" else ''}\""
  # custom command for content option0
  options.file ?= path.resolve options.cwd, 'Dockerfile' if options.cwd
  if options.content?
    options.log message: "Building from text: Docker won't have a context. ADD/COPY not working", level: 'WARN', module: 'nikita/docker/build'
    cmd += " - &lt;&lt;DOCKERFILE\n#{options.content}\nDOCKERFILE" if options.content?
  else if options.file?
    options.log message: "Building from Dockerfile: \"#{options.file}\"", level: 'INFO', module: 'nikita/docker/build'
    cmd += " -f #{options.file} #{options.cwd}"
  else
    options.log message: "Building from CWD", level: 'INFO', module: 'nikita/docker/build'
    cmd += ' .'
  @file
    if: options.content
    content: options.content
    source: source
    target: (content) -&gt;
      options.content = content
    from: options.from
    to: options.to
    match: options.match
    replace: options.replace
    append: options.append
    before: options.before
    write: options.write
  @call # Read Dockerfile if necessary to count steps
    unless: options.content
    handler: (_, callback) -&gt;
      options.log message: "Reading Dockerfile from : #{options.file}", level: 'INFO', module: 'nikita/lib/build'
      @fs.readFile ssh: options.ssh, target: options.file, encoding: 'utf8', (err, content) -&gt;
        return callback err if err
        options.content = content
        callback()
  @call -&gt; # Count steps
    for line in string.lines options.content
      number_of_step++ if /^(.*?)\s/.exec(line)?[1] in dockerfile_cmds
  @system.execute
    cmd: docker.wrap options, cmd
    cwd: options.cwd
  , (err, executed, stdout, stderr) -&gt;
    throw err if err
    container_id_hash = null
    lines = string.lines stderr
    lines = string.lines stdout
    number_of_cache = 0
    for k,  line of lines
      if (line.indexOf('Using cache') isnt  -1 )
        number_of_cache = number_of_cache + 1
      if (line.indexOf('Successfully built') isnt  -1 )
        container_id_hash = line.split(' ').pop().toString()
    userargs = [number_of_step isnt number_of_cache, container_id_hash, stdout, stderr]
  @next (err, status) -&gt;
    return callback err if err
    options.log if userargs[0]
    then message: "New image id #{userargs[1]}", level: 'INFO', module: 'nikita/lib/docker/build' 
    else message: "Identical image id #{userargs[1]}", level: 'INFO', module: 'nikita/lib/docker/build'
    callback null, userargs...
</code></pre>
<h2 id="modules-dependencies">Modules Dependencies</h2>
<pre><code>docker = require '../misc/docker'
string = require '../misc/string'
path = require 'path'
util = require 'util'
{merge} = require '../misc'
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../checksum.coffee/" class="btn btn-neutral float-right" title="Checksum.coffee">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../db/user/remove.coffee/" class="btn btn-neutral" title="Remove.coffee"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../db/user/remove.coffee/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../checksum.coffee/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
